<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AgriSense - Learning Center</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    .card-hover { transition: all 0.3s ease; }
    .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.15); }
    .progress-bar {
      height: 6px;
      background: #e5e7eb;
      border-radius: 3px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: #10b981;
      transition: width 0.3s ease;
    }
    .module-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease-out;
    }
    .module-content.show {
      max-height: 2000px;
      transition: max-height 0.5s ease-in;
    }
  </style>
</head>
<body class="bg-gray-50 font-sans">
  <!-- Header -->
    <header class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-4 py-4">
      <div class="flex justify-between items-center">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center"><span
              class="text-2xl">üå±</span></div>
          <div>
            <h1 class="text-xl font-bold text-gray-800" data-translate="site-name">AgriSense</h1>
            <p class="text-xs text-gray-600" data-translate="site-tagline">AI Crop Recommendation System</p>
          </div>
        </div>
        <div class="flex items-center space-x-4">
          <select id="languageSelect" class="px-3 py-1 border border-gray-300 rounded-md text-sm bg-white">
            <option value="en">English</option>
            <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
            <option value="kn">‡≤ï‡≤®‡≥ç‡≤®‡≤°</option>
          </select>
          <button id="mobileMenuBtn" class="md:hidden p-2"><span class="text-2xl">‚ò∞</span></button>
        </div>
      </div>
      <nav class="hidden md:block mt-4">
        <ul class="flex flex-wrap space-x-6 text-sm font-medium">
          <li><a href="index.html" class="hover:text-green-600 transition-colors" data-translate="nav-home">Home</a></li>
          <li><a href="crop-recommendation.html" class="hover:text-green-600 transition-colors" data-translate="nav-crop">Crop Recommendation</a></li>
          <li><a href="pest-detection.html" class="hover:text-green-600 transition-colors" data-translate="nav-pest">Pest Detection</a></li>
          <li><a href="soil-testing.html" class="hover:text-green-600 transition-colors" data-translate="nav-soil">Soil Testing</a></li>
          <li><a href="dashboard.html" class="hover:text-green-600 transition-colors" data-translate="nav-dashboard">Dashboard</a></li>
          <li><a href="community.html" class="hover:text-green-600 transition-colors" data-translate="nav-community">Community</a></li>
          <li><a href="about.html" class="hover:text-green-600 transition-colors" data-translate="nav-about">About</a></li>
        </ul>
      </nav>
      <!-- Mobile Nav -->
      <nav id="mobileNav" class="hidden md:hidden mt-4 border-t pt-4">
        <ul class="space-y-2">
          <li><a href="index.html" class="block py-2 hover:bg-gray-50 rounded px-2">Home</a></li>
          <li><a href="crop-recommendation.html" class="block py-2 hover:bg-gray-50 rounded px-2">Crop Recommendation</a></li>
          <li><a href="pest-detection.html" class="block py-2 hover:bg-gray-50 rounded px-2">Pest Detection</a></li>
          <li><a href="soil-testing.html" class="block py-2 hover:bg-gray-50 rounded px-2">Soil Testing</a></li>
          <li><a href="dashboard.html" class="block py-2 hover:bg-gray-50 rounded px-2">Dashboard</a></li>
          <li><a href="community.html" class="block py-2 hover:bg-gray-50 rounded px-2">Community</a></li>
          <li><a href="about.html" class="block py-2 hover:bg-gray-50 rounded px-2">About</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container mx-auto px-4 py-8">
    <!-- Hero Section -->
    <section class="bg-gradient-to-r from-green-500 to-green-700 text-white rounded-2xl p-8 mb-12">
      <div class="max-w-4xl mx-auto text-center">
        <h1 class="text-4xl md:text-5xl font-bold mb-4">Farmer's Learning Center</h1>
        <p class="text-xl mb-8">Enhance your farming knowledge with our expert-led courses</p>
        <div class="relative max-w-xl mx-auto">
          <input type="text" placeholder="Search courses..." class="w-full px-6 py-4 rounded-full text-gray-800 focus:outline-none focus:ring-2 focus:ring-green-300">
          <button class="absolute right-2 top-2 bg-green-600 hover:bg-green-700 text-white p-2 rounded-full">
            <i class="fas fa-search"></i>
          </button>
        </div>
      </div>
    </section>

    <!-- Courses Grid -->
    <section class="mb-16">
      <h2 class="text-3xl font-bold mb-8 text-gray-800">Featured Courses</h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8" id="coursesGrid">
        <!-- Courses will be dynamically inserted here -->
      </div>
    </section>

    <!-- Course Details Modal -->
    <div id="courseModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
      <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
        <div class="p-6">
          <div class="flex justify-between items-start mb-6">
            <div>
              <h2 id="modalCourseTitle" class="text-2xl font-bold text-gray-800"></h2>
              <p id="modalCourseDesc" class="text-gray-600 mt-2"></p>
            </div>
            <button id="closeModal" class="text-gray-500 hover:text-gray-700">
              <i class="fas fa-times text-2xl"></i>
            </button>
          </div>
          
          <div class="mb-6">
            <div class="flex items-center justify-between mb-2">
              <span class="text-sm font-medium">Course Progress</span>
              <span id="progressText" class="text-sm font-medium">0% Complete</span>
            </div>
            <div class="progress-bar">
              <div id="progressFill" class="progress-fill" style="width: 0%"></div>
            </div>
          </div>

          <div id="courseModules" class="space-y-4">
            <!-- Modules will be inserted here -->
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-12">
    <div class="container mx-auto px-4">
      <div class="grid md:grid-cols-3 gap-8">
        <div>
          <div class="flex items-center space-x-3 mb-4">
            <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
              <span class="text-xl">üå±</span>
            </div>
            <span class="text-xl font-bold">AgriSense</span>
          </div>
          <p class="text-gray-400 mb-4">Empowering farmers with AI-powered agricultural solutions for sustainable and profitable farming.</p>
          <div class="text-sm text-gray-500">¬© 2025 AgriSense Team | Built for Smart India Hackathon</div>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
          <ul class="space-y-2 text-gray-400">
            <li><a href="index.html" class="hover:text-green-400 transition-colors">Home</a></li>
            <li><a href="crop-recommendation.html" class="hover:text-green-400 transition-colors">Crop Recommendation</a></li>
            <li><a href="disease-detection.html" class="hover:text-green-400 transition-colors">Disease Detection</a></li>
            <li><a href="learning.html" class="hover:text-green-400 transition-colors">Learning Center</a></li>
            <li><a href="about.html" class="hover:text-green-400 transition-colors">About</a></li>
          </ul>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4">Contact Us</h4>
          <ul class="space-y-2 text-gray-400">
            <li class="flex items-center space-x-2">
              <i class="fas fa-envelope"></i>
              <span>contact@agrisense.in</span>
            </li>
            <li class="flex items-center space-x-2">
              <i class="fas fa-phone"></i>
              <span>+91 9876543210</span>
            </li>
            <li class="flex items-center space-x-2">
              <i class="fas fa-map-marker-alt"></i>
              <span>Bangalore, India</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // Course data
    const farmingCourses = [
      {
        id: 'organic-farming',
        title: 'Organic Farming Fundamentals',
        description: 'Learn the principles and practices of organic farming for sustainable agriculture',
        icon: 'leaf',
        color: '#22c55e',
        duration: '4-5 hours',
        modules: [
          {
            id: 'module-1',
            title: 'Introduction to Organic Farming',
            type: 'lesson',
            content: [
              'Organic farming is a method of crop and livestock production that involves much more than choosing not to use pesticides, fertilizers, genetically modified organisms, antibiotics and growth hormones.',
              'Organic farming focuses on maintaining soil health, ecosystem management, and promoting biodiversity.',
              'Key principles include crop rotation, green manures, compost, biological pest control, and mechanical cultivation.',
              'Organic farming systems rely on crop rotation, crop residues, animal manures, legumes, green manure, off-farm organic wastes, and biological pest control to maintain soil productivity and tilth.',
              'The goal is to optimize the health and productivity of interdependent communities of soil life, plants, animals and people.'
            ],
            videoUrl: 'https://youtu.be/SOcxRMOjXWY?si=Wdc2_qTl3TVZyG44',
            imageUrl: 'https://images.unsplash.com/photo-1500937386664-56d1dfef3854?w=800&q=80'
          },
          {
            id: 'module-2',
            title: 'Soil Management in Organic Farming',
            type: 'lesson',
            content: [
              'Healthy soil is the foundation of organic farming. Soil should be rich in organic matter and teeming with beneficial microorganisms.',
              'Composting is essential: Create compost from crop residues, animal manure, kitchen waste, and other organic materials.',
              'Green manuring involves growing specific crops and plowing them back into the soil to improve fertility.',
              'Crop rotation prevents soil depletion by alternating different crops in the same field across seasons.',
              'Avoid synthetic fertilizers. Use natural alternatives like bone meal, rock phosphate, and seaweed extracts.',
              'Maintain proper soil pH (6.0-7.0 for most crops) using natural amendments like lime or sulfur.',
              'Practice minimum tillage to preserve soil structure and reduce erosion.'
            ],
            videoUrl: 'https://youtu.be/heTxEsrPVdQ?si=Dse7l-qlYKHzCjJB',
            imageUrl: 'https://images.unsplash.com/photo-1574323347407-f5e1ad6d020b?w=800&q=80'
          },
          {
            id: 'module-3',
            title: 'Pest and Disease Management',
            type: 'lesson',
            content: [
              'Integrated Pest Management (IPM) is crucial in organic farming. Focus on prevention rather than cure.',
              'Biological control: Introduce beneficial insects like ladybugs, lacewings, and predatory mites to control pests.',
              'Companion planting: Some plants naturally repel pests. For example, marigolds repel nematodes, and basil repels flies.',
              'Crop rotation breaks pest and disease cycles by preventing pests from finding their host plants.',
              'Use organic pesticides only as a last resort: Neem oil, pyrethrin, and diatomaceous earth are approved organic options.',
              'Proper spacing and pruning improve air circulation, reducing fungal diseases.',
              'Remove and destroy infected plant parts immediately to prevent disease spread.',
              'Encourage biodiversity in your farm to create a balanced ecosystem that naturally controls pests.'
            ],
            videoUrl: 'https://youtu.be/m28inqnDKp8?si=oUe8dHaKiHv8mt_N',
            imageUrl: 'https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=800&q=80'
          },
          {
            id: 'module-4',
            title: 'Organic Certification and Marketing',
            type: 'lesson',
            content: [
              'Organic certification ensures that products meet strict organic standards set by regulatory bodies.',
              'In India, NPOP (National Programme for Organic Production) and PGS-India (Participatory Guarantee System) are the main certification systems.',
              'Transition period: Land must be managed organically for at least 3 years before certification.',
              'Maintain detailed records of all farming practices, inputs used, and harvest dates.',
              'Regular inspections by certification agencies are required to maintain certification.',
              'Marketing organic products: Emphasize health benefits, environmental sustainability, and premium quality.',
              'Price premium: Organic products typically command 20-50% higher prices than conventional products.',
              'Build trust with consumers through transparency and clear labeling.'
            ],
            videoUrl: 'https://youtu.be/3JX2xE8p2I4',
            imageUrl: 'https://images.unsplash.com/photo-1416879595882-3373a0480b5b?w=800&q=80'
          },
          {
            id: 'module-5',
            title: 'Organic Farming Quiz',
            type: 'quiz',
            content: [],
            quizQuestions: [
              {
                id: 'q1',
                question: 'What is the minimum transition period required for organic certification?',
                options: ['1 year', '2 years', '3 years', '5 years'],
                correctAnswer: 2,
                explanation: 'Land must be managed organically for at least 3 years before it can be certified as organic.'
              },
              {
                id: 'q2',
                question: 'Which of the following is NOT a principle of organic farming?',
                options: [
                  'Crop rotation',
                  'Use of synthetic fertilizers',
                  'Biological pest control',
                  'Green manuring'
                ],
                correctAnswer: 1,
                explanation: 'Organic farming strictly avoids synthetic fertilizers. It relies on natural methods like crop rotation, green manuring, and biological pest control.'
              },
              {
                id: 'q3',
                question: 'What is the ideal soil pH range for most crops in organic farming?',
                options: ['4.0-5.0', '5.0-6.0', '6.0-7.0', '7.0-8.0'],
                correctAnswer: 2,
                explanation: 'Most crops grow best in slightly acidic to neutral soil, with a pH range of 6.0-7.0.'
              },
              {
                id: 'q4',
                question: 'Which beneficial insect is commonly used for biological pest control?',
                options: ['Honeybee', 'Ladybug', 'Butterfly', 'Dragonfly'],
                correctAnswer: 1,
                explanation: 'Ladybugs are natural predators of aphids and other soft-bodied pests, making them valuable in organic pest management.'
              },
              {
                id: 'q5',
                question: 'What is the main purpose of companion planting in organic farming?',
                options: [
                  'Increase yield',
                  'Repel pests naturally',
                  'Reduce water usage',
                  'Improve soil structure'
                ],
                correctAnswer: 1,
                explanation: 'Companion planting helps repel pests naturally. For example, marigolds repel nematodes, and basil repels flies.'
              }
            ]
          }
        ]
      },
      {
        id: 'crop-management',
        title: 'Modern Crop Management',
        description: 'Master advanced crop management for maximum yield and quality',
        icon: 'seedling',
        color: '#3b82f6',
        duration: '5-6 hours',
        modules: []
      },
      {
        id: 'sustainable-agriculture',
        title: 'Sustainable Agriculture',
        description: 'Learn sustainable farming methods for long-term productivity',
        icon: 'recycle',
        color: '#10b981',
        duration: '4-5 hours',
        modules: []
      }
    ];

    // DOM Elements
    const coursesGrid = document.getElementById('coursesGrid');
    const courseModal = document.getElementById('courseModal');
    const closeModal = document.getElementById('closeModal');
    const modalCourseTitle = document.getElementById('modalCourseTitle');
    const modalCourseDesc = document.getElementById('modalCourseDesc');
    const courseModules = document.getElementById('courseModules');
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    
    // Track completed modules
    let completedModules = JSON.parse(localStorage.getItem('completedModules') || '{}');
    let currentCourseId = '';

    // Course card template
    function createCourseCard(course) {
      const card = document.createElement('div');
      card.className = 'bg-white rounded-xl overflow-hidden shadow-lg card-hover border border-gray-100';
      card.innerHTML = `
        <div class="h-2" style="background-color: ${course.color}"></div>
        <div class="p-6">
          <div class="flex items-center justify-center w-16 h-16 rounded-full mb-4" style="background-color: ${hexToRgba(course.color, 0.1)}">
            <i class="fas fa-${course.icon} text-2xl" style="color: ${course.color}"></i>
          </div>
          <h3 class="text-xl font-bold mb-2 text-gray-800">${course.title}</h3>
          <p class="text-gray-600 mb-4">${course.description}</p>
          <div class="flex justify-between items-center text-sm text-gray-500 mb-4">
            <span><i class="far fa-clock mr-1"></i> ${course.duration}</span>
            <span><i class="far fa-bookmark mr-1"></i> ${course.modules.length} Modules</span>
          </div>
          <div class="space-y-2">
            <button class="w-full bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg font-medium transition-colors view-course" data-course-id="${course.id}">
              Start Learning
            </button>
            <button class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg font-medium transition-colors save-course" data-course-id="${course.id}">
              <i class="far fa-bookmark mr-2"></i> Learn This Course
            </button>
          </div>
        </div>
      `;
      return card;
    }

    // Module template
    function createModuleElement(module, index) {
      const moduleEl = document.createElement('div');
      moduleEl.className = 'border border-gray-200 rounded-lg overflow-hidden';
      
      const isQuiz = module.type === 'quiz';
      const icon = isQuiz ? 'question-circle' : 'play-circle';
      const moduleId = `${currentCourseId}-${module.id}`;
      const isCompleted = completedModules[moduleId] || false;
      
      moduleEl.innerHTML = `
        <div class="bg-gray-50 p-4 cursor-pointer flex justify-between items-center module-header">
          <div class="flex items-center">
            <div class="w-10 h-10 rounded-full flex-shrink-0 flex items-center justify-center mr-3" style="background-color: ${isQuiz ? '#f59e0b20' : '#3b82f620'}">
              <i class="fas fa-${icon}" style="color: ${isQuiz ? '#f59e0b' : '#3b82f6'}"></i>
            </div>
            <div>
              <h4 class="font-medium text-gray-800">${module.title}</h4>
              <p class="text-sm text-gray-500">${isQuiz ? 'Quiz' : 'Lesson'} ‚Ä¢ ${module.content.length} ${module.content.length === 1 ? 'section' : 'sections'}</p>
            </div>
          </div>
          <div class="flex items-center">
            <label class="inline-flex items-center cursor-pointer">
              <input type="checkbox" class="form-checkbox h-5 w-5 text-green-500 rounded focus:ring-green-400 module-checkbox" 
                data-module-id="${moduleId}" ${isCompleted ? 'checked' : ''}>
              <span class="ml-2 text-sm text-gray-600">Complete</span>
            </label>
            <i class="fas fa-chevron-down text-gray-400 transition-transform ml-4"></i>
          </div>
        </div>
        <div class="module-content bg-white">
          <div class="p-4 border-t">
            ${module.videoUrl ? 
              `<div class="mt-4 mb-6">
                <div class="relative">
                  <img 
                    src="yt.jpg" 
                    alt="${module.title}" 
                    class="w-full h-48 object-cover rounded-lg cursor-pointer"
                    onclick="window.open('${module.videoUrl.includes('youtube.com') ? module.videoUrl : 'https://youtube.com/watch?v=' + module.videoUrl}', '_blank')"
                  >
                  <div class="absolute inset-0 flex items-center justify-center">
                    <div class="w-16 h-16 bg-black bg-opacity-60 rounded-full flex items-center justify-center hover:bg-opacity-80 transition-all">
                      <i class="fas fa-play text-white text-2xl"></i>
                    </div>
                  </div>
                </div>
              </div>` : 
              ''
            }
            ${module.content.length > 0 ? 
              `<div class="prose max-w-none">
                ${module.content.map(paragraph => `<p class="mb-4">${paragraph}</p>`).join('')}
              </div>` : 
              ''
            }
            ${isQuiz && module.quizQuestions ? 
              `<div class="mt-6">
                <h5 class="font-medium mb-4">Quiz: ${module.quizQuestions.length} Questions</h5>
                <button class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg start-quiz" data-questions='${JSON.stringify(module.quizQuestions)}'>
                  Start Quiz
                </button>
              </div>` : 
              ''
            }
          </div>
        </div>
      `;
      
      // Toggle module content
      const header = moduleEl.querySelector('.module-header');
      const content = moduleEl.querySelector('.module-content');
      const chevron = moduleEl.querySelector('.fa-chevron-down');
      
      header.addEventListener('click', () => {
        content.classList.toggle('show');
        chevron.style.transform = content.classList.contains('show') ? 'rotate(180deg)' : 'rotate(0)';
      });
      
      return moduleEl;
    }

    // Helper function to convert hex to rgba
    function hexToRgba(hex, alpha = 1) {
      const r = parseInt(hex.slice(1, 3), 16);
      const g = parseInt(hex.slice(3, 5), 16);
      const b = parseInt(hex.slice(5, 7), 16);
      return `rgba(${r}, ${g}, ${b}, ${alpha})`;
    }

    // Calculate course progress
    function calculateCourseProgress(courseId) {
      const course = farmingCourses.find(c => c.id === courseId);
      if (!course || !course.modules.length) return 0;
      
      const totalModules = course.modules.length;
      let completedCount = 0;
      
      course.modules.forEach(module => {
        const moduleId = `${courseId}-${module.id}`;
        if (completedModules[moduleId]) {
          completedCount++;
        }
      });
      
      return Math.round((completedCount / totalModules) * 100);
    }
    
    // Update progress bar
    function updateProgress(percent) {
      progressFill.style.width = `${percent}%`;
      progressText.textContent = `${percent}% Complete`;
    }
    
    // Toggle module completion
    function toggleModuleCompletion(moduleId, isChecked) {
      completedModules[moduleId] = isChecked;
      localStorage.setItem('completedModules', JSON.stringify(completedModules));
      
      // Update progress
      const progress = calculateCourseProgress(currentCourseId);
      updateProgress(progress);
    }
    
    // Show course details modal
    function showCourseDetails(courseId) {
      const course = farmingCourses.find(c => c.id === courseId);
      if (!course) return;
      
      currentCourseId = courseId;
      modalCourseTitle.textContent = course.title;
      modalCourseDesc.textContent = course.description;
      
      // Clear previous modules
      courseModules.innerHTML = '';
      
      // Add modules
      course.modules.forEach((module, index) => {
        courseModules.appendChild(createModuleElement(module, index));
      });
      
      // Update progress
      const progress = calculateCourseProgress(courseId);
      updateProgress(progress);
      
      // Add event listeners for checkboxes
      document.querySelectorAll('.module-checkbox').forEach(checkbox => {
        checkbox.addEventListener('change', (e) => {
          const moduleId = e.target.dataset.moduleId;
          toggleModuleCompletion(moduleId, e.target.checked);
        });
      });
      
      // Show modal
      courseModal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
    

    // Save course to dashboard
    function saveCourseToDashboard(courseId) {
      console.log('Saving course:', courseId);
      const course = farmingCourses.find(c => c.id === courseId);
      if (!course) {
        console.error('Course not found:', courseId);
        return;
      }
      
      // Get saved courses from localStorage or initialize empty array
      const savedCourses = JSON.parse(localStorage.getItem('savedCourses') || '[]');
      console.log('Current saved courses:', savedCourses);
      
      // Check if course is already saved
      const isAlreadySaved = savedCourses.some(c => c.id === courseId);
      console.log('Is already saved?', isAlreadySaved);
      
      if (!isAlreadySaved) {
        // Add course to saved courses with basic info
        const courseToSave = {
          id: course.id,
          title: course.title,
          description: course.description,
          icon: course.icon,
          color: course.color,
          savedAt: new Date().toISOString()
        };
        console.log('Adding course:', courseToSave);
        savedCourses.push(courseToSave);
        
        // Save back to localStorage
        localStorage.setItem('savedCourses', JSON.stringify(savedCourses));
        console.log('Saved to localStorage:', JSON.parse(localStorage.getItem('savedCourses')));
        
        // Show success message
        alert(`"${course.title}" has been added to your dashboard!`);
      } else {
        // If already saved, remove it
        const updatedCourses = savedCourses.filter(c => c.id !== courseId);
        localStorage.setItem('savedCourses', JSON.stringify(updatedCourses));
        
        // Update button text
        const button = document.querySelector(`.save-course[data-course-id="${courseId}"]`);
        if (button) {
          button.innerHTML = '<i class="far fa-bookmark mr-2"></i> Learn This Course';
        }
        
        alert(`"${course.title}" has been removed from your dashboard.`);
      }
      
      // Update button state
      updateSaveButtonState(courseId);
    }
    
    // Update save button state based on saved status
    function updateSaveButtonState(courseId) {
      const button = document.querySelector(`.save-course[data-course-id="${courseId}"]`);
      if (!button) return;
      
      const savedCourses = JSON.parse(localStorage.getItem('savedCourses') || '[]');
      const isSaved = savedCourses.some(c => c.id === courseId);
      
      if (isSaved) {
        button.innerHTML = '<i class="fas fa-check mr-2"></i> Added to Dashboard';
        button.classList.remove('bg-blue-500', 'hover:bg-blue-600');
        button.classList.add('bg-green-500', 'hover:bg-green-600');
      } else {
        button.innerHTML = '<i class="far fa-bookmark mr-2"></i> Learn This Course';
        button.classList.remove('bg-green-500', 'hover:bg-green-600');
        button.classList.add('bg-blue-500', 'hover:bg-blue-600');
      }
    }

    // Event Listeners
    document.addEventListener('DOMContentLoaded', () => {
      // Render courses
      farmingCourses.forEach(course => {
        coursesGrid.appendChild(createCourseCard(course));
      });
      
      // Close modal
      closeModal.addEventListener('click', () => {
        courseModal.classList.add('hidden');
        courseModal.classList.remove('flex');
        document.body.style.overflow = 'auto';
      });
      
      // Close modal when clicking outside
      courseModal.addEventListener('click', (e) => {
        if (e.target === courseModal) {
          courseModal.classList.add('hidden');
          courseModal.classList.remove('flex');
          document.body.style.overflow = 'auto';
        }
      });
      
      // Handle course card clicks
      document.addEventListener('click', (e) => {
        // Handle view course
        if (e.target.closest('.view-course')) {
          const courseId = e.target.closest('.view-course').dataset.courseId;
          showCourseDetails(courseId);
        }
        // Handle save course
        else if (e.target.closest('.save-course')) {
          const courseId = e.target.closest('.save-course').dataset.courseId;
          saveCourseToDashboard(courseId);
        }
      });
      
      // Update save button states on page load
      farmingCourses.forEach(course => {
        updateSaveButtonState(course.id);
      });
      
      // Mobile menu toggle
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const mobileNav = document.getElementById('mobileNav');
      if (mobileMenuBtn && mobileNav) {
        mobileMenuBtn.addEventListener('click', () => {
          mobileNav.classList.toggle('hidden');
        });
      }
    });
  </script>
</body>
</html>
